<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MPhoto</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>
    <div class="container">
        <h1>MPhoto</h1>
        <div class="tabs">
            <button onclick="showTab(0)" id="tab0">Code Input</button>
            <button onclick="showTab(1)" id="tab1" disabled>Face Input</button>
            <button onclick="showTab(2)" id="tab2" disabled>Thumbnails</button>
        </div>

        <!-- Tab 1: Code Input -->
        <div class="tab-content" id="tab-content-0">
            <input type="text" id="invite-code" maxlength="10" placeholder="Enter 10-digit invite code">
            <button onclick="submitCode()">Submit</button>
            <div id="recaptcha-container" class="g-recaptcha" data-sitekey="6LduOvsqAAAAAFq70zQvjSds5g16UclT-JkEVqak" style="margin-top: 10px;"></div>
            <div id="bib-info"></div>
        </div>

        <!-- Tab 2: Face Input -->
        <div class="tab-content" id="tab-content-1" style="display: none;">
            <p id="bib-display"></p>
            <button onclick="submitFaces()" id="submit-faces">Submit</button>
            <div class="face-previews">
                <div class="face-unit">
                    <div class="face-box" id="face-0"><div class="diagonal"></div></div>
                    <div class="face-controls">
                        <button class="copy-btn" id="copy-0" title="Paste the selected face" disabled>Paste</button>
                        <label><input type="checkbox" id="use-0" title="Use it to search photo" disabled> Use</label>
                    </div>
                </div>
                <div class="face-unit">
                    <div class="face-box" id="face-1"><div class="diagonal"></div></div>
                    <div class="face-controls">
                        <button class="copy-btn" id="copy-1" title="Paste the selected face" disabled>Paste</button>
                        <label><input type="checkbox" id="use-1" title="Use it to search photo" disabled> Use</label>
                    </div>
                </div>
                <div class="face-unit">
                    <div class="face-box" id="face-2"><div class="diagonal"></div></div>
                    <div class="face-controls">
                        <button class="copy-btn" id="copy-2" title="Paste the selected face" disabled>Paste</button>
                        <label><input type="checkbox" id="use-2" title="Use it to search photo" disabled> Use</label>
                    </div>
                </div>
            </div>
            <div class="crop-area">
                <input type="file" id="image-input" accept="image/*" onchange="loadImage()">
                <img id="crop-image" style="display: none;">
            </div>
        </div>

        <!-- Tab 3: Thumbnails -->
        <div class="tab-content" id="tab-content-2" style="display: none;">
            <div class="controls" id="thumbnail-controls-top">
                <button onclick="selectAll()">All</button>
                <button onclick="selectNone()">None</button>
                <button onclick="selectInverse()">Inverse</button>
                <button onclick="download()">Download</button>
            </div>
            <hr class="divider">
            <p id="total-photos" class="total-photos"></p>
            <div id="thumbs-grid" class="thumbs-grid"></div>
            <p id="no-photos-message" style="display: none; text-align: center; color: #888;">No photos found for the bib and face uploaded.</p>
            <hr class="divider">
            <div class="controls" id="thumbnail-controls-bottom" style="display: none;">
                <button onclick="selectAll()">All</button>
                <button onclick="selectNone()">None</button>
                <button onclick="selectInverse()">Inverse</button>
                <button onclick="download()">Download</button>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>
    <script src="/static/script.js"></script>
    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9236e4271a4725e3',t:'MTc0MjQ5MTM0Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9239c78b5a117b91',t:'MTc0MjUyMTYyNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9239ff5fedd9c006',t:'MTc0MjUyMzkxNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>
